<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-API Doc/Account Structure">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.3.1">
<title data-rh="true">Account Structure | Auticuro</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://financial_platform.pages.awx.im/Auticuro/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://financial_platform.pages.awx.im/Auticuro/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://financial_platform.pages.awx.im/Auticuro/docs/API Doc/Account Structure"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Account Structure | Auticuro"><meta data-rh="true" name="description" content="The Account Structure"><meta data-rh="true" property="og:description" content="The Account Structure"><link data-rh="true" rel="icon" href="/Auticuro/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://financial_platform.pages.awx.im/Auticuro/docs/API Doc/Account Structure"><link data-rh="true" rel="alternate" href="https://financial_platform.pages.awx.im/Auticuro/docs/API Doc/Account Structure" hreflang="en"><link data-rh="true" rel="alternate" href="https://financial_platform.pages.awx.im/Auticuro/docs/API Doc/Account Structure" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/Auticuro/blog/rss.xml" title="Auticuro RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Auticuro/blog/atom.xml" title="Auticuro Atom Feed"><link rel="stylesheet" href="/Auticuro/assets/css/styles.6dc9aec6.css">
<link rel="preload" href="/Auticuro/assets/js/runtime~main.db8b443a.js" as="script">
<link rel="preload" href="/Auticuro/assets/js/main.e77f3fff.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/Auticuro/"><div class="navbar__logo"><img src="/Auticuro/img/logo.svg" alt="Auticuro Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/Auticuro/img/logo.svg" alt="Auticuro Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Auticuro</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/Auticuro/docs/intro">Documentation</a><a class="navbar__item navbar__link" href="/Auticuro/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/airwallex/Auticuro" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Source<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Auticuro/docs/intro">Auticuro Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Auticuro/docs/category/introduction">Introduction</a><button aria-label="Toggle the collapsible sidebar category &#x27;Introduction&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Auticuro/docs/Quick Start">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Auticuro/docs/category/design">Design</a><button aria-label="Toggle the collapsible sidebar category &#x27;Design&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/Auticuro/docs/category/api-doc">API Doc</a><button aria-label="Toggle the collapsible sidebar category &#x27;API Doc&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/Auticuro/docs/API Doc/Account Structure">Account Structure</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/Auticuro/docs/category/account-management-apis">Account management APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Account management APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/Auticuro/docs/category/balance-operation-apis">Balance Operation APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Balance Operation APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/Auticuro/docs/category/transactional-apis">Transactional APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Transactional APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/Auticuro/docs/category/query-apis">Query APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Query APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Auticuro/docs/FAQ">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/Auticuro/docs/category/evaluation">Evaluation</a><button aria-label="Toggle the collapsible sidebar category &#x27;Evaluation&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/Auticuro/docs/ReleaseNotes">Release Notes</a></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/Auticuro/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/Auticuro/docs/category/api-doc"><span itemprop="name">API Doc</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Account Structure</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Account Structure</h1></header><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-account-structure">The Account Structure<a href="#the-account-structure" class="hash-link" aria-label="Direct link to The Account Structure" title="Direct link to The Account Structure">​</a></h3><p>An account is divided into four parts: TransactionSection, Available, ReservedSection, and Configuration.</p><p><img loading="lazy" alt="image info" src="/Auticuro/assets/images/account_structure-4bec1330997b434eeaeec0519f1a6221.svg" width="640" height="601" class="img_ev3q"></p><p>TransactionSection is a mapping from transactionId to its PendingIn amount and PendingOut amount
manipulated by the TCC interfaces.</p><p>ReservedSection is a mapping from reservationId to its reserved amount, which supports Reserve,
IncrementalReserve, Release, and PartialRelease interface.</p><p>The Reserve interface allows reserving an amount of money within an account for future usage
purposes by moving the money from the available section to the reserved section. The only permitted
operation on that reserved money is the Release interface which moves the money back to the available
section. IncrementalReserve and PartialRelease are just variants of Reserve and Release.</p><p>The Configuration contains fields like UpperLimit, LowerLimit, State, Currency, and Version, which
could be updated by UpdateUpperLimit, UpdateLowerLimit, LockAccount, and UnlockAccount interface.</p><p>The Transfer interface is a bilateral money movement between two accounts inside the same Auticuro
shard. BatchBalanceOperation is a batch of money movement for accounts inside the same Auticuro
shard, and each money movement credits or debits an amount from one account.</p><p>Updating the account follows a Copy-On-Write pattern. Instead of directly updating the account,
each modification will be applied to a copy of the account. Each time the copy-on-write happens,
we will assign an increased version number to it. so we know the entire history of the account modification.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-account-protobuf-description">The account protobuf description:<a href="#the-account-protobuf-description" class="hash-link" aria-label="Direct link to The account protobuf description:" title="Direct link to The account protobuf description:">​</a></h3><ul><li><strong>AccountConfig</strong>: The configuration settings for the account.</li><li><strong>Balance</strong>: The current balance of the account, including available funds, reservations, and
pending transactions.</li><li><strong>AccountState</strong>: The current state of the account, such as normal, locked, or deleted.</li><li><strong>account_id</strong>: A unique identifier for the account.</li><li><strong>version_number</strong>: A monotonically increasing version number that increments with each change to
the account.</li></ul><div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message Account {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AccountConfig config = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Balance balance = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AccountState state = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  string account_id = 4;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  uint64 version_number = 5; // monotonically increasing, increased by 1 upon any account changes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message AccountConfig {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  BalanceLimit balance_limit = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AssetClass asset_class = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message BalanceLimit {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  string upper = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  string lower = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">message AssetClass {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  oneof asset_class {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Cash cash = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  message Cash {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    string currency = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">enum AccountState {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  InvalidState = 0;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Deleted = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Locked = 2;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Normal = 3;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="balance-structure">Balance Structure<a href="#balance-structure" class="hash-link" aria-label="Direct link to Balance Structure" title="Direct link to Balance Structure">​</a></h3><p>The <strong>Balance</strong> message contains information about the account&#x27;s balances, including:</p><ul><li><strong>available</strong>: The available balance for general use.</li><li><strong>reservations</strong>: A map of reservation IDs to reserved amounts, representing funds set aside for
specific purposes.</li><li><strong>pending_in</strong>: A map of transaction IDs to pending incoming amounts, representing funds expected
to be credited to the account.</li><li><strong>pending_out</strong>: A map of transaction IDs to pending outgoing amounts, representing funds expected
to be debited from the account.</li></ul><div class="language-protobuf codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-protobuf codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">message Balance {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  string available = 1;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  map&lt;string, string&gt; reservations = 2; // reservation_id -&gt; reservation amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  map&lt;string, string&gt; pending_in = 3; // txn_id -&gt; pending_in amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  map&lt;string, string&gt; pending_out = 4; // txn_id -&gt; pending_out amount</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/Auticuro/docs/category/api-doc"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">API Doc</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/Auticuro/docs/category/account-management-apis"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Account management APIs</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#the-account-structure" class="table-of-contents__link toc-highlight">The Account Structure</a></li><li><a href="#the-account-protobuf-description" class="table-of-contents__link toc-highlight">The account protobuf description:</a></li><li><a href="#balance-structure" class="table-of-contents__link toc-highlight">Balance Structure</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Auticuro, Airwallex. Built with Docusaurus.</div></div></div></footer></div>
<script src="/Auticuro/assets/js/runtime~main.db8b443a.js"></script>
<script src="/Auticuro/assets/js/main.e77f3fff.js"></script>
</body>
</html>